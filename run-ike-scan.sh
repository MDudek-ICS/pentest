#!/bin/sh
#
#
# This script takes an ike-scan target specification as paramter.
# This can be a single IP address or an input file (-f <filename>)

#
# This script runs each transform with a standard ike-scan
# Followed by each transform with an aggressive mode ike-scan and
# then followed by a --showbackoff ike-scan
#
# Encryption algorithms: DES, Triple-DES, AES/128, AES/192 and AES/256
ENCLIST="1 5 7/128 7/192 7/256"
# Hash algorithms: MD5 and SHA1
HASHLIST="1 2"
# Authentication methods: Pre-Shared Key, RSA Signatures, Hybrid Mode and XAUTH
AUTHLIST="1 2 3 4 5 64221 65001"
# Diffie-Hellman groups: 1, 2 and 5
GROUPLIST="1 2 5"
#

echo "------------------"
echo "| NORMAL IKESCAN |"
echo "------------------"


for ENC in $ENCLIST; do
   for HASH in $HASHLIST; do
      for AUTH in $AUTHLIST; do
         for GROUP in $GROUPLIST; do
            echo "scanning enc=$ENC - hash=$HASH - auth=$AUTH - group=$GROUP"
            sudo ike-scan -M --trans=$ENC,$HASH,$AUTH,$GROUP $*
         done
      done
   done
done

echo "----------------------"
echo "| AGGRESSIVE IKESCAN |"
echo "----------------------"


for ENC in $ENCLIST; do
   for HASH in $HASHLIST; do
      for AUTH in $AUTHLIST; do
         for GROUP in $GROUPLIST; do
            echo "scanning enc=$ENC - hash=$HASH - auth=$AUTH - group=$GROUP"
            sudo ike-scan -M -A --trans=$ENC,$HASH,$AUTH,$GROUP $*
         done
      done
   done
done

echo "----------------"
echo "| SHOW BACKOFF |"
echo "----------------"
sudo ike-scan --showbackoff $*
